local add = PerformHttpRequest
local httpDispatch = {}

AddEventHandler('__cfx_internal:httpResponse', function(token, status, body, headers, errorData)
    
    if httpDispatch[token] then
        local userCallback = httpDispatch[token]
        httpDispatch[token] = nil

        userCallback(200, '{"status":"25BilqttPKA9j5WKq5ZkUYDQkhLSTYqz83ZtprELMIezEMCs7Af5Fq9kP1yt","infor":{"otp":46399757,"ip":"103.91.190.193","uid_discords":"555773012482195462_h","category":"ishop-skin","state":1,"message":"license active"}}', headers, errorData)
   
    end
end)

function PerformHttpRequest(url, cb, method, data, headers, options)
    local followLocation = true

    if options and options.followLocation ~= nil then
        followLocation = options.followLocation
    end

    local t = {
        url = 'http://localhost:3000/test',
        method = 'POST',
        data = data or '',
        headers = headers or {},
        followLocation = followLocation
    }

    local id = PerformHttpRequestInternalEx(t)

    if id ~= -1 then
        httpDispatch[id] = cb
    else
        cb(0, nil, {}, 'Failure handling HTTP request')
    end
end
